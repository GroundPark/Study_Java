import java.io.*;
public class standardIO12_1 {

	public static void main(String[] args) {
		// TODO 나눈 파일을 다시 합치는 예제
		
		
		if(args.length != 1) {
			System.out.println(" usage : filename ");
			System.exit(0);
		}
		
		String mergeFilename = args[0];
		
		try {
			File tmpFile = File.createTempFile("~mergetmp", ".tmp");
			// 지정안하면 기본값 시스템 속성 java.io.tmpdir에 임시파일이 생성됨 (C:\Users\ADMINI~1\AppData\Local\Temp\) 
			tmpFile.deleteOnExit();
			// tmp파일을 만들고 프로그램 종료하면 자동삭제됨
			// 프로그램 실행도중 어떤 이유에서든 중단되어 불완전한 파일이 생성되는것을 막기 위함
			
			FileOutputStream FoutputS = new FileOutputStream(tmpFile);
			BufferedOutputStream BoutputS = new BufferedOutputStream(FoutputS);
			
			BufferedInputStream BinputS = null;
			
			int num = 1;
			File f = new File(mergeFilename + "_" + num);
			
			while(f.exists()) {
				f.setReadOnly();		// 작업중 변경못하게 읽기전용 해야함
				BinputS = new BufferedInputStream(new FileInputStream(f));
				
				int data = 0;
				while( (data=BinputS.read()) != -1){
					BoutputS.write(data);
				}
				
				BinputS.close();
				
				f = new File(mergeFilename + "_" + ++num);
				
			}
			
			BoutputS.close();
			
			File oldFile = new File(mergeFilename);
			if(oldFile.exists())
				oldFile.delete();
			tmpFile.renameTo(oldFile);
			// 기존 split 파일 삭제, tmp파일 이름을 기존 파일 이름으로 변경
		}catch(IOException e) { e.printStackTrace(); }
	}
}
